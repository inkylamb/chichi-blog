(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{550:function(s,a,t){"use strict";t.r(a);var e=t(4),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("这个小书描述了怎样结合rust和webassembly")]),s._v(" "),t("h2",{attrs:{id:"适合谁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#适合谁"}},[s._v("#")]),s._v(" 适合谁")]),s._v(" "),t("p",[s._v("这个书适合于那些对于想使用rust编译成webAssembly实现更快更可靠的web编码。你需要知道一些rust以及了解JavaScript和html，css。你不需要达到精通其中任何一个。")]),s._v(" "),t("p",[s._v("不懂rust？"),t("a",{attrs:{href:"https://kaisery.github.io/trpl-zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Rust 程序设计语言"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("不懂html，css，js？ "),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/",target:"_blank",rel:"noopener noreferrer"}},[s._v("MDN"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"怎样阅读这本书"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#怎样阅读这本书"}},[s._v("#")]),s._v(" 怎样阅读这本书")]),s._v(" "),t("p",[s._v("你需要阅读使用rust结合webAssembly的动力,同样的首先需要更加熟悉概念和背景。")]),s._v(" "),t("p",[s._v("这个教程需要从头到尾阅读，你需要按照步骤书写，编译，运行你自己的代码。如果你以前没有使用过rust 结合 webassembly 跟随教程。仔细阅读参考切面可能在任何地方出现。")]),s._v(" "),t("h2",{attrs:{id:"为什么选择rust结合webassembly"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么选择rust结合webassembly"}},[s._v("#")]),s._v(" 为什么选择rust结合webassembly")]),s._v(" "),t("h3",{attrs:{id:"更底层的控制更高效的工程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更底层的控制更高效的工程"}},[s._v("#")]),s._v(" 更底层的控制更高效的工程")]),s._v(" "),t("p",[s._v("JavaScript web 应用一直难以达到可靠的表现，javascript的动态类型系统和垃圾回收机制，对于可靠没有任何帮助。如果你散漫的游走在JIT的快码上面，看起来小小的代码变化将会导致性能剧烈下降。")]),s._v(" "),t("p",[s._v("rust将会给程序提供更底层的控制和更可靠的表现，它摆脱了像javascript那样不确定的垃圾回收。程序员可以控制单一状态和内存释放。")]),s._v(" "),t("h3",{attrs:{id:"更小-wasm-文件大小"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更小-wasm-文件大小"}},[s._v("#")]),s._v(" 更小.wasm 文件大小")]),s._v(" "),t("p",[s._v("当文件必须在互联网传递的时候，代码的大小显得十分重要。rust不需要运行依赖，所以不会有垃圾回收器这种让代码文件变大的额外开销。")]),s._v(" "),t("h3",{attrs:{id:"不需要重写所有的东西"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#不需要重写所有的东西"}},[s._v("#")]),s._v(" 不需要重写所有的东西")]),s._v(" "),t("p",[s._v("已经存在的代码不需要抛弃，你可以在现有基础功能上，选择对于javascript中对于性能敏感的函数移植使用rust来实现就可以马上获得收益。如果你觉得不需要修改的地方可以保持原状。")]),s._v(" "),t("h3",{attrs:{id:"和其他的东西也可以表现的很好"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#和其他的东西也可以表现的很好"}},[s._v("#")]),s._v(" 和其他的东西也可以表现的很好")]),s._v(" "),t("p",[s._v("rust 和 webassembly 一起使用可以完好的与javascript的工具链存在。它支持ecmascript 的 模块化 你能够继续使用你喜欢的工具链比如npm，webpack和greenkeeper这些。")]),s._v(" "),t("h3",{attrs:{id:"让你所期待的"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#让你所期待的"}},[s._v("#")]),s._v(" 让你所期待的")]),s._v(" "),t("p",[s._v("rust具有开发人员期望的现代比那里设施，比如：\n强有力的包管理工具\n零抽象成本\n活跃的社区（不要脸还在笑）")]),s._v(" "),t("h2",{attrs:{id:"背景和观念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#背景和观念"}},[s._v("#")]),s._v(" 背景和观念")]),s._v(" "),t("p",[s._v("本节提供了深入研究Rust和WebAssembly开发的必要上下文。")]),s._v(" "),t("h3",{attrs:{id:"什么是webassembly"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是webassembly"}},[s._v("#")]),s._v(" 什么是webAssembly")]),s._v(" "),t("p",[s._v("webassembly是简单的机器模型和广泛的执行规范，他被设计的更加的轻巧紧凑并且执行速度接近机器码")]),s._v(" "),t("p",[s._v("作为一个程序语言，webAssembly 是包含两个相同的格式结构，尽管使用方式不同：")]),s._v(" "),t("ol",[t("li",[t("p",[s._v(".wat 格式叫做webassembly 文本 使用 S表达式和LIsp方言拥有相似的特性比如（scheme和clojure）")])]),s._v(" "),t("li",[t("p",[s._v(".wasm 是比较低级的目的是在wasm虚拟机里面直接使用，从概念上讲类似于ELF和Mach-O")])])]),s._v(" "),t("p",[s._v("作为参考这是在.wat阶乘的算法：")]),s._v(" "),t("div",{staticClass:"language-wat line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('(module\n  (func $fac (param f64) (result f64)\n    get_local 0\n    f64.const 1\n    f64.lt\n    if (result f64)\n      f64.const 1\n    else\n      get_local 0\n      get_local 0\n      f64.const 1\n      f64.sub\n      call $fac\n      f64.mul\n    end)\n  (export "fac" (func $fac)))\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("如果好奇怎么搞使用wat2wasm demo 和下面的例子")]),s._v(" "),t("h2",{attrs:{id:"线性储存"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#线性储存"}},[s._v("#")]),s._v(" 线性储存")]),s._v(" "),t("p",[s._v("webAssembly 拥有简单的储存模型，一个wasm模型拥有的单线程存储，本质上是字节平面的数组。这个内存可以增加为64倍数的大小，不能再缩减了。")]),s._v(" "),t("h2",{attrs:{id:"webassembly-不仅仅可以运行在web"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webassembly-不仅仅可以运行在web"}},[s._v("#")]),s._v(" webAssembly 不仅仅可以运行在web")]),s._v(" "),t("p",[s._v("尽管目前它引起了javascript和web社区的普遍关注，但是wasm并没有对自己的运行环境设置限制。因此，可以推测wasm将会成为各种运行环境的一种可执行文件格式。当然在今天，wasm联系最为 密切的还是javascript，不管是在web端还是node服务端。")]),s._v(" "),t("h2",{attrs:{id:"配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),t("p",[s._v("这个章节描述怎么样使用rust编译出webassemble程序以及配合javascript的整合。")]),s._v(" "),t("h2",{attrs:{id:"rust工具链"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rust工具链"}},[s._v("#")]),s._v(" rust工具链")]),s._v(" "),t("p",[s._v("你需要标准的rust工具链，包括rustup，rusttc以及cargo。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.rust-lang.org/tools/install",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里介绍rust工具链"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("rust与webassembly的使用经验是基于稳定的版本，所以我们可以不需要使用一些实验性的功能。但是需要1.3或者更高的rust版本。")]),s._v(" "),t("h2",{attrs:{id:"wasm-pack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#wasm-pack"}},[s._v("#")]),s._v(" wasm-pack")]),s._v(" "),t("p",[s._v("wasm-pack 是一个集构建发布rust webassembly产物的一站式商城。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://rustwasm.github.io/wasm-pack/installer/",target:"_blank",rel:"noopener noreferrer"}},[s._v("wasm-pack"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"cargo-generate"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cargo-generate"}},[s._v("#")]),s._v(" cargo-generate")]),s._v(" "),t("p",[s._v("cargo-generae 帮助你快速使用git上面的模板构建一个rust项目。")]),s._v(" "),t("p",[s._v("安装cargo-generate的命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\ncargo "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" cargo-generate\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("切换源：找到当前用户目录下 /Users/baoyachi/.cargo/ 的.cargo 文件夹，进入.cargo 当前目录，在当前目下创建 config 文件 ，打开 config 文件，编写以下内容：")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('[source.crates-io]\nregistry = "https://github.com/rust-lang/crates.io-index"\nreplace-with = \'ustc\'\n[source.ustc]\nregistry = "git://mirrors.ustc.edu.cn/crates.io-index"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"npm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#npm"}},[s._v("#")]),s._v(" npm")]),s._v(" "),t("p",[s._v("npm 是一个javascript包管理工具。我们将会使用它打包和开发服务。在最后的教程里面我们将会编译.wasm给npm登记")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.npmjs.com/get-npm",target:"_blank",rel:"noopener noreferrer"}},[s._v("获取npm"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("如果你已经安装npm，确保已经使用下面的命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" npm@latest -g\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"helo-world"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#helo-world"}},[s._v("#")]),s._v(" Helo,World")]),s._v(" "),t("p",[s._v('这个章节将会给你展示如何创建第一个，rust结合webassembly程序：一个页面提示框提示"Hello world" 确认开始之前你已经安装了上面的工具。')]),s._v(" "),t("h2",{attrs:{id:"下载模板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载模板"}},[s._v("#")]),s._v(" 下载模板")]),s._v(" "),t("p",[s._v("这个工程模板")])])}),[],!1,null,null,null);a.default=r.exports}}]);